import{b as N}from"./chunk-MJL4YBW4.js";import{i as j,l as L}from"./chunk-UXOIYKMU.js";import{a as A,b as F}from"./chunk-FGEALCX4.js";import"./chunk-CP6ZTTNU.js";import"./chunk-BTNTQWIB.js";import{a as B}from"./chunk-TSMETG7O.js";import"./chunk-HNQGWLA6.js";import{a as z}from"./chunk-5PPEK6NX.js";import"./chunk-KJMQ5L5H.js";import"./chunk-NULHEHFH.js";import"./chunk-KEGNGRCI.js";import"./chunk-4YRY4IP2.js";import"./chunk-LBDSJBCK.js";import{La as k,Na as D,Oa as w,Pa as O,l as E,o as I,q as M,va as T}from"./chunk-SFRASIIN.js";import{Jc as _,Kb as o,Lb as m,Mb as g,Qc as P,Ra as r,Sa as b,Tc as C,Ub as f,Vc as S,Wb as h,ca as v,dc as d,eb as c,ec as y,fc as x,hb as p,qb as e,rb as t,sb as s,yb as u}from"./chunk-D3OC6ZHD.js";var U=i=>["/dashboard/payments",i];function W(i,n){i&1&&s(0,"button",24)}function V(i,n){if(i&1&&s(0,"button",25),i&2){let a=u();p("disabled",a.availableBalance<=0)}}function $(i,n){if(i&1&&(e(0,"div",9)(1,"div",10)(2,"div",26),s(3,"i",27),t(),e(4,"div")(5,"div",13),o(6),d(7,"currency"),t(),e(8,"div",14),o(9,"Available"),t()()()()),i&2){let a=u();r(6),m(y(7,1,a.availableBalance))}}function q(i,n){if(i&1&&(e(0,"div",28)(1,"h3",2),o(2),t(),s(3,"button",29),t()),i&2){let a=u();r(2),g("Recent ",a.isClient?"Payments":"Earnings","")}}function G(i,n){i&1&&(e(0,"tr")(1,"th"),o(2,"Project"),t(),e(3,"th"),o(4,"Amount"),t(),e(5,"th"),o(6,"Status"),t(),e(7,"th"),o(8,"Date"),t(),e(9,"th"),o(10,"Actions"),t()())}function H(i,n){if(i&1&&(e(0,"tr")(1,"td")(2,"div",30),o(3),t(),e(4,"div",31),o(5),t()(),e(6,"td")(7,"span",30),o(8),d(9,"currency"),t()(),e(10,"td"),s(11,"p-tag",32),t(),e(12,"td"),o(13),d(14,"date"),t(),e(15,"td"),s(16,"button",33),t()()),i&2){let a=n.$implicit,l=u();r(3),m(a.project_title||"Project Payment"),r(2),m(a.description),r(3),m(y(9,7,a.amount)),r(3),p("value",a.status)("severity",l.getStatusSeverity(a.status)),r(2),m(x(14,9,a.created_at,"medium")),r(3),p("routerLink",h(12,U,a.id))}}function J(i,n){i&1&&s(0,"button",39)}function K(i,n){if(i&1&&(e(0,"tr")(1,"td",34)(2,"div",35),s(3,"i",36),e(4,"p",37),o(5),t(),c(6,J,1,0,"button",38),t()()()),i&2){let a=u();r(5),m(a.isClient?"No payments made yet":"No earnings yet"),r(),p("ngIf",a.isClient)}}var R=class i{constructor(n,a){this.paymentService=n;this.tokenService=a}isClient=!1;loading=!1;recentPayments=[];totalAmount=0;completedPayments=0;pendingPayments=0;availableBalance=0;ngOnInit(){let n=this.tokenService.getCurrentUser();this.isClient=n?.type===M.CLIENT,this.loadDashboardData()}loadDashboardData(){this.loading=!0,this.paymentService.getPaymentStats().subscribe({next:n=>{this.isClient&&n.spending_stats?(this.totalAmount=n.spending_stats.total_spent||0,this.pendingPayments=n.spending_stats.pending_payments||0,this.completedPayments=this.totalAmount-this.pendingPayments):!this.isClient&&n.earnings_stats&&(this.totalAmount=n.earnings_stats.total_earned||0,this.pendingPayments=n.earnings_stats.pending_earnings||0,this.completedPayments=this.totalAmount-this.pendingPayments,this.availableBalance=n.earnings_stats.available_balance||0)},error:n=>console.error("Error loading stats:",n)}),this.paymentService.getPayments({page:1,page_size:5}).subscribe({next:n=>{this.recentPayments=n.results||[],this.loading=!1},error:n=>{console.error("Error loading payments:",n),this.loading=!1}})}getStatusSeverity(n){switch(n){case"completed":return"success";case"pending":return"warning";case"failed":return"danger";default:return"info"}}static \u0275fac=function(a){return new(a||i)(b(z),b(B))};static \u0275cmp=v({type:i,selectors:[["app-payment-dashboard"]],standalone:!0,features:[f],decls:52,vars:17,consts:[[1,"payment-dashboard"],[1,"flex","justify-content-between","align-items-center","mb-4"],[1,"m-0"],[1,"text-500","mt-1","mb-0"],[1,"flex","gap-2"],["pButton","","label","Pay for Project","icon","pi pi-credit-card","class","p-button-success","routerLink","/dashboard/payments/pay",4,"ngIf"],["pButton","","label","Withdraw Funds","icon","pi pi-money-bill","class","p-button-success","routerLink","/dashboard/payments/withdraw",3,"disabled",4,"ngIf"],[1,"grid","mb-4"],[1,"col-12","md:col-3"],[1,"stats-card"],[1,"stats-content"],[1,"stats-icon","bg-blue-100"],[1,"pi","pi-wallet","text-blue-600"],[1,"stats-value"],[1,"stats-label"],[1,"stats-icon","bg-green-100"],[1,"pi","pi-check-circle","text-green-600"],[1,"stats-icon","bg-orange-100"],[1,"pi","pi-clock","text-orange-600"],["class","stats-card",4,"ngIf"],["pTemplate","header"],[3,"value","loading"],["pTemplate","body"],["pTemplate","emptymessage"],["pButton","","label","Pay for Project","icon","pi pi-credit-card","routerLink","/dashboard/payments/pay",1,"p-button-success"],["pButton","","label","Withdraw Funds","icon","pi pi-money-bill","routerLink","/dashboard/payments/withdraw",1,"p-button-success",3,"disabled"],[1,"stats-icon","bg-purple-100"],[1,"pi","pi-dollar","text-purple-600"],[1,"flex","justify-content-between","align-items-center","p-3"],["pButton","","label","View All","icon","pi pi-eye","routerLink","/dashboard/payments/history",1,"p-button-text"],[1,"font-medium"],[1,"text-sm","text-500"],[3,"value","severity"],["pButton","","icon","pi pi-eye",1,"p-button-rounded","p-button-text","p-button-sm",3,"routerLink"],["colspan","5",1,"text-center","p-4"],[1,"empty-state"],[1,"pi","pi-wallet","text-4xl","text-300","mb-3"],[1,"text-500"],["pButton","","label","Make First Payment","icon","pi pi-plus","class","p-button-sm","routerLink","/dashboard/payments/pay",4,"ngIf"],["pButton","","label","Make First Payment","icon","pi pi-plus","routerLink","/dashboard/payments/pay",1,"p-button-sm"]],template:function(a,l){a&1&&(e(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),o(4),t(),e(5,"p",3),o(6),t()(),e(7,"div",4),c(8,W,1,0,"button",5)(9,V,1,1,"button",6),t()(),e(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11),s(15,"i",12),t(),e(16,"div")(17,"div",13),o(18),d(19,"currency"),t(),e(20,"div",14),o(21),t()()()()(),e(22,"div",8)(23,"div",9)(24,"div",10)(25,"div",15),s(26,"i",16),t(),e(27,"div")(28,"div",13),o(29),d(30,"currency"),t(),e(31,"div",14),o(32,"Completed"),t()()()()(),e(33,"div",8)(34,"div",9)(35,"div",10)(36,"div",17),s(37,"i",18),t(),e(38,"div")(39,"div",13),o(40),d(41,"currency"),t(),e(42,"div",14),o(43,"Pending"),t()()()()(),e(44,"div",8),c(45,$,10,3,"div",19),t()(),e(46,"p-card"),c(47,q,4,1,"ng-template",20),e(48,"p-table",21),c(49,G,11,0,"ng-template",20)(50,H,17,14,"ng-template",22)(51,K,7,2,"ng-template",23),t()()()),a&2&&(r(4),m(l.isClient?"Payments":"Earnings"),r(2),g(" ",l.isClient?"Manage your project payments":"Track your earnings and withdrawals"," "),r(2),p("ngIf",l.isClient),r(),p("ngIf",!l.isClient),r(9),m(y(19,11,l.totalAmount)),r(3),g(" ",l.isClient?"Total Spent":"Total Earned"," "),r(8),m(y(30,13,l.completedPayments)),r(11),m(y(41,15,l.pendingPayments)),r(5),p("ngIf",!l.isClient),r(3),p("value",l.recentPayments)("loading",l.loading))},dependencies:[S,_,C,P,I,E,D,k,T,O,w,L,j,F,A,N],styles:[".payment-dashboard[_ngcontent-%COMP%]   .stats-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;box-shadow:0 2px 4px #0000001a;height:100%}.payment-dashboard[_ngcontent-%COMP%]   .stats-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.payment-dashboard[_ngcontent-%COMP%]   .stats-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.5rem}.payment-dashboard[_ngcontent-%COMP%]   .stats-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--text-color)}.payment-dashboard[_ngcontent-%COMP%]   .stats-label[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-color-secondary);margin-top:.25rem}.payment-dashboard[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem}"]})};export{R as PaymentDashboardComponent};

import{b as q}from"./chunk-JIRGFBDA.js";import{a as V,b as z}from"./chunk-FGEALCX4.js";import{a as G}from"./chunk-5PPEK6NX.js";import{La as A,Na as L,Oa as N,Pa as O,i as k,k as B,l as j,o as F,ra as x}from"./chunk-SFRASIIN.js";import{Jc as w,Kb as a,Lb as l,Mb as u,Qc as T,Ra as r,Sa as s,Tb as C,Tc as M,Ub as h,Vc as R,Wb as P,ca as g,dc as c,eb as d,ec as y,fc as D,hb as m,la as S,ma as b,qb as n,rb as t,sb as v,wb as E,xb as I,yb as p}from"./chunk-D3OC6ZHD.js";var J=i=>["/dashboard/contracts",i];function K(i,o){if(i&1&&(n(0,"div",11)(1,"label",12),a(2,"Fee"),t(),n(3,"span"),a(4),c(5,"currency"),t()()),i&2){let e=p(2);r(4),l(y(5,1,e.payment.fee_amount))}}function Q(i,o){if(i&1&&(n(0,"div",11)(1,"label",12),a(2,"Net Amount"),t(),n(3,"span"),a(4),c(5,"currency"),t()()),i&2){let e=p(2);r(4),l(y(5,1,e.payment.net_amount))}}function U(i,o){if(i&1&&(n(0,"div",11)(1,"label",12),a(2,"Payment Method"),t(),n(3,"span"),a(4),t()()),i&2){let e=p(2);r(4),l(e.payment.payment_method)}}function W(i,o){if(i&1&&(n(0,"div",11)(1,"label",12),a(2,"Transaction ID"),t(),n(3,"span"),a(4),t()()),i&2){let e=p(2);r(4),l(e.payment.transaction_id)}}function X(i,o){if(i&1&&(n(0,"div",18)(1,"label",12),a(2,"Description"),t(),n(3,"p"),a(4),t()()),i&2){let e=p(2);r(4),l(e.payment.description)}}function Y(i,o){if(i&1&&(n(0,"div",22)(1,"h3"),a(2,"Contract Details"),t(),n(3,"div",23)(4,"a",24),a(5),t(),v(6,"p-tag",14),t()()),i&2){let e=p(2);r(4),m("routerLink",P(4,J,e.payment.contract.id)),r(),u(" ",e.payment.contract.proposal==null||e.payment.contract.proposal.job==null?null:e.payment.contract.proposal.job.title," "),r(),m("value",e.payment.contract.status)("severity",e.getContractStatusSeverity(e.payment.contract.status))}}function Z(i,o){if(i&1&&(n(0,"div")(1,"h3"),a(2,"Milestone Details"),t(),n(3,"p",25),a(4),t(),n(5,"p"),a(6),t(),n(7,"div",26)(8,"span"),a(9),c(10,"currency"),t(),v(11,"p-tag",14),t()()),i&2){let e=p(2);r(4),l(e.payment.milestone.title),r(2),l(e.payment.milestone.description),r(3),u("Amount: ",y(10,5,e.payment.milestone.amount),""),r(2),m("value",e.payment.milestone.status)("severity",e.getMilestoneStatusSeverity(e.payment.milestone.status))}}function $(i,o){if(i&1&&(n(0,"div",22)(1,"h3"),a(2,"Payer"),t(),n(3,"p",27),a(4),t(),n(5,"small",28),a(6),t()()),i&2){let e=p(2);r(4),l(e.payment.payer.username),r(2),l(e.payment.payer.email)}}function ee(i,o){if(i&1&&(n(0,"div")(1,"h3"),a(2,"Payee"),t(),n(3,"p",27),a(4),t(),n(5,"small",28),a(6),t()()),i&2){let e=p(2);r(4),l(e.payment.payee.username),r(2),l(e.payment.payee.email)}}function te(i,o){if(i&1){let e=E();n(0,"div",1)(1,"div",2)(2,"div")(3,"h2",3),a(4,"Payment Details"),t(),n(5,"p",4),a(6),t()(),n(7,"div",5),v(8,"button",6),n(9,"button",7),I("click",function(){S(e);let _=p();return b(_.downloadReceipt())}),t()()(),n(10,"div",8)(11,"div",9)(12,"p-card")(13,"div",8)(14,"div",10)(15,"div",11)(16,"label",12),a(17,"Amount"),t(),n(18,"span",13),a(19),c(20,"currency"),t()(),n(21,"div",11)(22,"label",12),a(23,"Status"),t(),v(24,"p-tag",14),t(),n(25,"div",11)(26,"label",12),a(27,"Type"),t(),n(28,"span",15),a(29),t()(),n(30,"div",11)(31,"label",12),a(32,"Date"),t(),n(33,"span"),a(34),c(35,"date"),t()()(),n(36,"div",10),d(37,K,6,3,"div",16)(38,Q,6,3,"div",16)(39,U,5,1,"div",16)(40,W,5,1,"div",16),t()(),d(41,X,5,1,"div",17),t(),n(42,"p-card",18),d(43,Y,7,6,"div",19)(44,Z,12,7,"div",20),t()(),n(45,"div",21)(46,"p-card"),d(47,$,7,2,"div",19)(48,ee,7,2,"div",20),t()()()()}if(i&2){let e=p();r(6),u("Transaction #",e.payment.id,""),r(13),l(y(20,15,e.payment.amount)),r(5),m("value",e.payment.status)("severity",e.getStatusSeverity(e.payment.status)),r(5),l(e.payment.type),r(5),l(D(35,17,e.payment.created_at,"medium")),r(3),m("ngIf",e.payment.fee_amount),r(),m("ngIf",e.payment.net_amount),r(),m("ngIf",e.payment.payment_method),r(),m("ngIf",e.payment.transaction_id),r(),m("ngIf",e.payment.description),r(2),m("ngIf",e.payment.contract),r(),m("ngIf",e.payment.milestone),r(3),m("ngIf",e.payment.payer),r(),m("ngIf",e.payment.payee)}}var H=class i{constructor(o,e,f,_){this.route=o;this.router=e;this.paymentService=f;this.messageService=_}payment=null;loading=!1;ngOnInit(){let o=this.route.snapshot.params.id;if(!o){this.router.navigate(["/dashboard/payments"]);return}this.loadPayment(o)}loadPayment(o){this.loading=!0,this.paymentService.getPayment(o).subscribe({next:e=>{this.payment=e,this.loading=!1},error:e=>{console.error("Error loading payment:",e),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load payment details"}),this.router.navigate(["/dashboard/payments"])}})}downloadReceipt(){this.payment&&this.paymentService.getPaymentReceipt(this.payment.id).subscribe({next:o=>{window.open(o.url,"_blank")},error:o=>{console.error("Error downloading receipt:",o),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to download receipt"})}})}getStatusSeverity(o){switch(o){case"completed":return"success";case"pending":return"warning";case"failed":return"danger";default:return"info"}}getContractStatusSeverity(o){switch(o){case"active":return"success";case"completed":return"info";case"cancelled":return"danger";default:return"warning"}}getMilestoneStatusSeverity(o){switch(o){case"completed":return"success";case"in_progress":return"info";case"paid":return"success";case"pending":return"warning";default:return"info"}}static \u0275fac=function(e){return new(e||i)(s(k),s(B),s(G),s(x))};static \u0275cmp=g({type:i,selectors:[["app-payment-detail"]],standalone:!0,features:[C([x]),h],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"flex","justify-content-between","align-items-center","mb-4"],[1,"m-0"],[1,"text-500","mt-2","mb-0"],[1,"flex","gap-2"],["pButton","","icon","pi pi-arrow-left","label","Back","routerLink","/dashboard/payments",1,"p-button-text"],["pButton","","icon","pi pi-download","label","Download Receipt",3,"click"],[1,"grid"],[1,"col-12","md:col-8"],[1,"col-12","md:col-6"],[1,"mb-3"],[1,"block","font-bold","mb-2"],[1,"text-2xl"],[3,"value","severity"],[1,"capitalize"],["class","mb-3",4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["class","mb-4",4,"ngIf"],[4,"ngIf"],[1,"col-12","md:col-4"],[1,"mb-4"],[1,"flex","align-items-center","gap-2"],[1,"text-primary","hover:underline",3,"routerLink"],[1,"font-bold","mb-2"],[1,"flex","align-items-center","gap-3","mt-3"],[1,"mb-1"],[1,"text-500"]],template:function(e,f){e&1&&d(0,te,49,20,"div",0),e&2&&m("ngIf",f.payment)},dependencies:[R,w,M,T,F,j,L,A,O,N,z,V,q],encapsulation:2})};export{H as PaymentDetailComponent};
